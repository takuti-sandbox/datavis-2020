{"version":3,"file":"bundle.js","sources":["useWorldAtlas.js","useData.js","BubbleMap/Marks.js","BubbleMap/index.js","DateHistogram/AxisBottom.js","DateHistogram/AxisLeft.js","DateHistogram/Marks.js","DateHistogram/index.js","index.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { json } from 'd3';\nimport { feature, mesh } from 'topojson';\n\nconst jsonUrl = 'https://unpkg.com/world-atlas@2.0.2/countries-50m.json'\n\nexport const useWorldAtlas = () => {\n  const [data, setData] = useState(null);\n\n  useEffect(() => {\n    json(jsonUrl).then(topology => {\n      const { countries, land } = topology.objects;\n    \tsetData({\n        land: feature(topology, land),\n        interiors: mesh(topology, countries, (a, b) => a !== b)\n      })\n    });\n  }, []);\n  \n  return data;\n};\n","import { useState, useEffect } from 'react';\nimport { csv } from 'd3';\n\nconst csvUrl =\n  'https://gist.githubusercontent.com/curran/a9656d711a8ad31d812b8f9963ac441c/raw/267eac8b97d161c479d950ffad3ddd5ce2d1f370/MissingMigrants-Global-2019-10-08T09-47-14-subset.csv';\n\nconst row = (d) => {\n  d.coords = d['Location Coordinates']\n    .split(',')\n    .map((d) => +d)\n    .reverse();\n  d['Total Dead and Missing'] = +d[\n    'Total Dead and Missing'\n  ];\n  d['Reported Date'] = new Date(d['Reported Date']);\n  return d;\n};\n\nexport const useData = () => {\n  const [data, setData] = useState(null);\n\n  useEffect(() => {\n    csv(csvUrl, row).then(setData);\n  }, []);\n\n  return data;\n};\n","import {\n  geoNaturalEarth1,\n  geoPath,\n  geoGraticule,\n} from 'd3';\n\nconst projection = geoNaturalEarth1();\nconst path = geoPath(projection);\nconst graticule = geoGraticule();\n\nexport const Marks = ({\n  worldAtlas: { land, interiors },\n  data,\n  sizeScale,\n  sizeValue,\n}) => (\n  <g className=\"marks\">\n    <path className=\"sphere\" d={path({ type: 'Sphere' })} />\n    <path className=\"graticule\" d={path(graticule())} />\n    {land.features.map((feature) => (\n      <path className=\"land\" d={path(feature)} />\n    ))}\n    <path className=\"interiors\" d={path(interiors)} />\n    {data.map((d) => {\n      const [x, y] = projection(d.coords);\n      return (\n        <circle cx={x} cy={y} r={sizeScale(sizeValue(d))} />\n      );\n    })}\n  </g>\n);\n","import React from 'react';\nimport { scaleSqrt, max } from 'd3';\nimport { Marks } from './Marks';\n\nexport const BubbleMap = ({ data, worldAtlas }) => {\n  const sizeValue = (d) => d['Total Dead and Missing'];\n  const maxRadius = 15;\n\n  const sizeScale = scaleSqrt()\n    .domain([0, max(data, sizeValue)])\n    .range([0, maxRadius]);\n\n  return (\n    <Marks\n      worldAtlas={worldAtlas}\n      data={data}\n      sizeScale={sizeScale}\n      sizeValue={sizeValue}\n    />\n  );\n};\n","export const AxisBottom = ({ xScale, innerHeight, tickFormat, tickOffset = 3 }) =>\n  xScale.ticks().map(tickValue => (\n    <g\n      className=\"tick\"\n      key={tickValue}\n      transform={`translate(${xScale(tickValue)},0)`}\n    >\n      <line y2={innerHeight} />\n      <text style={{ textAnchor: 'middle' }} dy=\".71em\" y={innerHeight + tickOffset}>\n        {tickFormat(tickValue)}\n      </text>\n    </g>\n  ));\n","export const AxisLeft = ({ yScale, innerWidth, tickOffset = 3 }) =>\n  yScale.ticks().map(tickValue => (\n    <g className=\"tick\" transform={`translate(0,${yScale(tickValue)})`}>\n      <line x2={innerWidth} />\n      <text\n        key={tickValue}\n        style={{ textAnchor: 'end' }}\n        x={-tickOffset}\n        dy=\".32em\"\n      >\n        {tickValue}\n      </text>\n    </g>\n  ));\n","export const Marks = ({\n  data,\n  xScale,\n  yScale,\n  tooltipFormat,\n  innerHeight,\n}) =>\n  data.map((d) => (\n    <rect\n      className=\"mark\"\n      x={xScale(d.x0)}\n      y={yScale(d.y)}\n      width={xScale(d.x1) - xScale(d.x0)}\n      height={innerHeight - yScale(d.y)}\n    >\n      <title>{tooltipFormat(d.y)}</title>\n    </rect>\n  ));","import {\n  scaleLinear,\n  scaleTime,\n  max,\n  timeFormat,\n  extent,\n  histogram as bin,\n  timeMonths,\n  sum,\n} from 'd3';\nimport { AxisBottom } from './AxisBottom';\nimport { AxisLeft } from './AxisLeft';\nimport { Marks } from './Marks';\n\nconst margin = { top: 0, right: 30, bottom: 20, left: 50 };\nconst xAxisLabelOffset = 50;\nconst yAxisLabelOffset = 30;\n\nexport const DateHistogram = ({ data, width, height }) => {\n  const innerHeight = height - margin.top - margin.bottom;\n  const innerWidth = width - margin.left - margin.right;\n\n  const xAxisTickFormat = timeFormat('%m/%d/%Y');\n\n  const xValue = (d) => d['Reported Date'];\n  const xAxisLabel = 'Time';\n\n  const yValue = (d) => d['Total Dead and Missing'];\n  const yAxisLabel = 'Total Dead and Missing';\n\n  const xScale = scaleTime()\n    .domain(extent(data, xValue))\n    .range([0, innerWidth])\n    .nice();\n\n  const [start, stop] = xScale.domain();\n\n  const binnedData = bin()\n    .value(xValue)\n    .domain(xScale.domain())\n    .thresholds(timeMonths(start, stop))(data)\n    .map((array) => ({\n      y: sum(array, yValue),\n      x0: array.x0,\n      x1: array.x1,\n    }));\n\n  const yScale = scaleLinear()\n    .domain([0, max(binnedData, (d) => d.y)])\n    .range([innerHeight, 0]);\n\n  return (\n    <>\n      <rect width={width} height={height} fill=\"white\" />\n      <g\n        transform={`translate(${margin.left},${margin.top})`}\n      >\n        <AxisBottom\n          xScale={xScale}\n          innerHeight={innerHeight}\n          tickFormat={xAxisTickFormat}\n          tickOffset={5}\n        />\n        <text\n          className=\"axis-label\"\n          textAnchor=\"middle\"\n          transform={`translate(${-yAxisLabelOffset},${\n            innerHeight / 2\n          }) rotate(-90)`}\n        >\n          {yAxisLabel}\n        </text>\n        <AxisLeft\n          yScale={yScale}\n          innerWidth={innerWidth}\n          tickOffset={5}\n        />\n        <text\n          className=\"axis-label\"\n          x={innerWidth / 2}\n          y={innerHeight + xAxisLabelOffset}\n          textAnchor=\"middle\"\n        >\n          {xAxisLabel}\n        </text>\n        <Marks\n          data={binnedData}\n          xScale={xScale}\n          yScale={yScale}\n          tooltipFormat={(d) => d}\n          innerHeight={innerHeight}\n        />\n      </g>\n    </>\n  );\n};\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { useWorldAtlas } from './useWorldAtlas';\nimport { useData } from './useData';\nimport { BubbleMap } from './BubbleMap/index.js';\nimport { DateHistogram } from './DateHistogram/index.js';\n\nconst width = 960;\nconst height = 500;\nconst dateHistogramSize = 0.2;\n\nconst App = () => {\n  const worldAtlas = useWorldAtlas();\n  const data = useData();\n\n  if (!worldAtlas || !data) {\n    return <pre>Loading....</pre>;\n  }\n\n  return (\n    <svg width={width} height={height}>\n      <BubbleMap data={data} worldAtlas={worldAtlas} />\n      <g transform={`translate(0,${height - dateHistogramSize * height})`}>\n        <DateHistogram data={data} width={width} height={dateHistogramSize * height} />\n      </g>\n    </svg>\n  );\n};\n\nconst rootElement = document.getElementById('root');\nReactDOM.render(<App />, rootElement);\n"],"names":["const","useState","useEffect","json","feature","mesh","csv","geoNaturalEarth1","geoPath","geoGraticule","scaleSqrt","max","React","Marks","timeFormat","scaleTime","extent","bin","timeMonths","sum","scaleLinear","ReactDOM"],"mappings":";;;;;;;;EAIAA,IAAM,OAAO,GAAG,yDAAwD;AACxE;EACOA,IAAM,aAAa,eAAS;EACnC,SAAuB,GAAGC,gBAAQ,CAAC,IAAI;IAA9B;IAAM,qBAA0B;AACzC;EACA,EAAEC,iBAAS,aAAO;EAClB,IAAIC,OAAI,CAAC,OAAO,CAAC,CAAC,IAAI,WAAC,UAAY;EACnC,aAA+B,GAAG,QAAQ,CAAC;QAA7B;QAAW,oBAA0B;EACnD,KAAK,OAAO,CAAC;EACb,QAAQ,IAAI,EAAEC,gBAAO,CAAC,QAAQ,EAAE,IAAI,CAAC;EACrC,QAAQ,SAAS,EAAEC,aAAI,CAAC,QAAQ,EAAE,SAAS,YAAG,CAAC,EAAE,CAAC,WAAK,CAAC,KAAK,IAAC,CAAC;EAC/D,OAAO,EAAC;EACR,KAAK,CAAC,CAAC;EACP,GAAG,EAAE,EAAE,CAAC,CAAC;EACT;EACA,EAAE,OAAO,IAAI,CAAC;EACd,CAAC;;ECjBDL,IAAM,MAAM;EACZ,EAAE,+KAA+K,CAAC;AAClL;EACAA,IAAM,GAAG,aAAI,CAAC,EAAK;EACnB,EAAE,CAAC,CAAC,MAAM,GAAG,CAAC,CAAC,sBAAsB,CAAC;EACtC,KAAK,KAAK,CAAC,GAAG,CAAC;EACf,KAAK,GAAG,WAAE,CAAC,WAAK,CAAC,IAAC,CAAC;EACnB,KAAK,OAAO,EAAE,CAAC;EACf,EAAE,CAAC,CAAC,wBAAwB,CAAC,GAAG,CAAC,CAAC;EAClC,IAAI,wBAAwB;EAC5B,GAAG,CAAC;EACJ,EAAE,CAAC,CAAC,eAAe,CAAC,GAAG,IAAI,IAAI,CAAC,CAAC,CAAC,eAAe,CAAC,CAAC,CAAC;EACpD,EAAE,OAAO,CAAC,CAAC;EACX,CAAC,CAAC;AACF;EACOA,IAAM,OAAO,eAAS;EAC7B,SAAuB,GAAGC,gBAAQ,CAAC,IAAI;IAA9B;IAAM,qBAA0B;AACzC;EACA,EAAEC,iBAAS,aAAO;EAClB,IAAII,MAAG,CAAC,MAAM,EAAE,GAAG,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;EACnC,GAAG,EAAE,EAAE,CAAC,CAAC;AACT;EACA,EAAE,OAAO,IAAI,CAAC;EACd,CAAC;;ECpBDN,IAAM,UAAU,GAAGO,mBAAgB,EAAE,CAAC;EACtCP,IAAM,IAAI,GAAGQ,UAAO,CAAC,UAAU,CAAC,CAAC;EACjCR,IAAM,SAAS,GAAGS,eAAY,EAAE,CAAC;AACjC;EACOT,IAAM,KAAK,gBAKjB;wCAJe;mCAAM;6CACpB;wBACA;kCACA;;;;EAEF,EAAE,4BAAG,WAAU;EACf,IAAI,+BAAM,WAAU,QAAQ,EAAC,GAAG,IAAI,CAAC,EAAE,IAAI,EAAE,QAAQ,EAAE,GAAE;EACzD,IAAI,+BAAM,WAAU,WAAW,EAAC,GAAG,IAAI,CAAC,SAAS,EAAE,GAAE;EACrD,IAAK,IAAI,CAAC,QAAQ,CAAC,GAAG,WAAE,OAAO;EAC/B,MAAM,+BAAM,WAAU,MAAM,EAAC,GAAG,IAAI,CAAC,OAAO,GAAE,CAAG;EACjD,QAAK;EACL,IAAI,+BAAM,WAAU,WAAW,EAAC,GAAG,IAAI,CAAC,SAAS,GAAE;EACnD,IAAK,IAAI,CAAC,GAAG,WAAE,CAAC,EAAK;EACrB,aAAkB,GAAG,UAAU,CAAC,CAAC,CAAC,MAAM;QAA3B;QAAG,eAA0B;EAC1C,MAAM;EACN,QAAQ,iCAAQ,IAAI,CAAE,EAAC,IAAI,CAAE,EAAC,GAAG,SAAS,CAAC,SAAS,CAAC,CAAC,CAAC,GAAE,CAAG;EAC5D,QAAQ;EACR,KAAK,CAAE;EACP,GAAM;EACN;GAAC;;EC1BMA,IAAM,SAAS,gBAAwB,EAAK;wBAAjB;;AAAkB;EACpD,EAAEA,IAAM,SAAS,aAAI,CAAC,WAAK,CAAC,CAAC,wBAAwB,IAAC,CAAC;EACvD,EAAEA,IAAM,SAAS,GAAG,EAAE,CAAC;AACvB;EACA,EAAEA,IAAM,SAAS,GAAGU,YAAS,EAAE;EAC/B,KAAK,MAAM,CAAC,CAAC,CAAC,EAAEC,MAAG,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC,CAAC;EACtC,KAAK,KAAK,CAAC,CAAC,CAAC,EAAE,SAAS,CAAC,CAAC,CAAC;AAC3B;EACA,EAAE;EACF,IAAIC,yCAAC;EACL,MAAM,YAAY,UAAW,EACvB,MAAM,IAAK,EACX,WAAW,SAAU,EACrB,WAAW,WAAU,CACrB;EACN,IAAI;EACJ,CAAC;;ECpBMZ,IAAM,UAAU,gBAAuD;8BAAzC;wCAAa;;iFAAyB;;aACzE,MAAM,CAAC,KAAK,EAAE,CAAC,GAAG,WAAC;EACrB,IAAI;EACJ,MAAM,WAAU,MAAM,EAChB,KAAK,SAAU,EACf,4BAAwB,MAAM,CAAC,SAAS,EAAC;EAE/C,MAAM,+BAAM,IAAI,aAAY;EAC5B,MAAM,+BAAM,OAAO,EAAE,UAAU,EAAE,QAAQ,EAAG,EAAC,IAAG,OAAO,EAAC,GAAG,WAAW,GAAG;EACzE,QAAS,UAAU,CAAC,SAAS,CAAE;EAC/B,OAAa;EACb,KAAQ;EACR,MAAG;GAAC;;ECZGA,IAAM,QAAQ,gBAA0C;8BAA5B;;iFAAyB;;aAC1D,MAAM,CAAC,KAAK,EAAE,CAAC,GAAG,WAAC;EACrB,IAAI,4BAAG,WAAU,MAAM,EAAC,8BAA0B,MAAM,CAAC,SAAS,EAAC;EACnE,MAAM,+BAAM,IAAI,YAAW;EAC3B,MAAM;EACN,QAAQ,KAAK,SAAU,EACf,OAAO,EAAE,UAAU,EAAE,KAAK,EAAG,EAC7B,GAAG,CAAC,UAAW,EACf,IAAG;EAEX,QAAS,SAAU;EACnB,OAAa;EACb,KAAQ;EACR,MAAG;GAAC;;ECbGA,IAAMa,OAAK,gBAMjB;0BAJC;8BACA;8BACA;4CACA;;;aAEA,IAAI,CAAC,GAAG,WAAE,CAAC;EACb,IAAI;EACJ,MAAM,WAAU,MAAM,EAChB,GAAG,MAAM,CAAC,CAAC,CAAC,EAAE,CAAE,EAChB,GAAG,MAAM,CAAC,CAAC,CAAC,CAAC,CAAE,EACf,OAAO,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,GAAG,MAAM,CAAC,CAAC,CAAC,EAAE,CAAE,EACnC,QAAQ,WAAW,GAAG,MAAM,CAAC,CAAC,CAAC,CAAC;EAEtC,MAAM,oCAAQ,aAAa,CAAC,CAAC,CAAC,CAAC,CAAE,EAAQ;EACzC,KAAW;EACX,MAAG;GAAC;;ECHJb,IAAM,MAAM,GAAG,EAAE,GAAG,EAAE,CAAC,EAAE,KAAK,EAAE,EAAE,EAAE,MAAM,EAAE,EAAE,EAAE,IAAI,EAAE,EAAE,EAAE,CAAC;EAC3DA,IAAM,gBAAgB,GAAG,EAAE,CAAC;EAC5BA,IAAM,gBAAgB,GAAG,EAAE,CAAC;AAC5B;EACOA,IAAM,aAAa,gBAA2B,EAAK;wBAApB;0BAAO;;AAAc;EAC3D,EAAEA,IAAM,WAAW,GAAG,MAAM,GAAG,MAAM,CAAC,GAAG,GAAG,MAAM,CAAC,MAAM,CAAC;EAC1D,EAAEA,IAAM,UAAU,GAAG,KAAK,GAAG,MAAM,CAAC,IAAI,GAAG,MAAM,CAAC,KAAK,CAAC;AACxD;EACA,EAAEA,IAAM,eAAe,GAAGc,aAAU,CAAC,UAAU,CAAC,CAAC;AACjD;EACA,EAAEd,IAAM,MAAM,aAAI,CAAC,WAAK,CAAC,CAAC,eAAe,IAAC,CAAC;EAC3C,EAAEA,IAAM,UAAU,GAAG,MAAM,CAAC;AAC5B;EACA,EAAEA,IAAM,MAAM,aAAI,CAAC,WAAK,CAAC,CAAC,wBAAwB,IAAC,CAAC;EACpD,EAAEA,IAAM,UAAU,GAAG,wBAAwB,CAAC;AAC9C;EACA,EAAEA,IAAM,MAAM,GAAGe,YAAS,EAAE;EAC5B,KAAK,MAAM,CAACC,SAAM,CAAC,IAAI,EAAE,MAAM,CAAC,CAAC;EACjC,KAAK,KAAK,CAAC,CAAC,CAAC,EAAE,UAAU,CAAC,CAAC;EAC3B,KAAK,IAAI,EAAE,CAAC;AACZ;EACA,WAAqB,GAAG,MAAM,CAAC,MAAM;IAA5B;IAAO,oBAAwB;AACxC;EACA,EAAEhB,IAAM,UAAU,GAAGiB,YAAG,EAAE;EAC1B,KAAK,KAAK,CAAC,MAAM,CAAC;EAClB,KAAK,MAAM,CAAC,MAAM,CAAC,MAAM,EAAE,CAAC;EAC5B,KAAK,UAAU,CAACC,aAAU,CAAC,KAAK,EAAE,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC;EAC9C,KAAK,GAAG,WAAE,KAAK,YAAM;EACrB,MAAM,CAAC,EAAEC,MAAG,CAAC,KAAK,EAAE,MAAM,CAAC;EAC3B,MAAM,EAAE,EAAE,KAAK,CAAC,EAAE;EAClB,MAAM,EAAE,EAAE,KAAK,CAAC,EAAE;EAClB,KAAK,IAAC,CAAC,CAAC;AACR;EACA,EAAEnB,IAAM,MAAM,GAAGoB,cAAW,EAAE;EAC9B,KAAK,MAAM,CAAC,CAAC,CAAC,EAAET,MAAG,CAAC,UAAU,YAAG,CAAC,WAAK,CAAC,CAAC,IAAC,CAAC,CAAC,CAAC;EAC7C,KAAK,KAAK,CAAC,CAAC,WAAW,EAAE,CAAC,CAAC,CAAC,CAAC;AAC7B;EACA,EAAE;EACF,IAAI;EACJ,MAAM,+BAAM,OAAO,KAAM,EAAC,QAAQ,MAAO,EAAC,MAAK,SAAO;EACtD,MAAM;EACN,QAAQ,4BAAwB,MAAM,CAAC,KAAI,UAAI,MAAM,CAAC,IAAG;EAEzD,QAAQ,qBAAC;EACT,UAAU,QAAQ,MAAO,EACf,aAAa,WAAY,EACzB,YAAY,eAAgB,EAC5B,YAAY,GAAE;EAExB,QAAQ;EACR,UAAU,WAAU,YAAY,EACtB,YAAW,QAAQ,EACnB,4BAAwB,CAAC,iBAAgB,UACvC,WAAW,GAAG,EAAC;EAG3B,UAAW,UAAW;EACtB;EACA,QAAQ,qBAAC;EACT,UAAU,QAAQ,MAAO,EACf,YAAY,UAAW,EACvB,YAAY,GAAE;EAExB,QAAQ;EACR,UAAU,WAAU,YAAY,EACtB,GAAG,UAAU,GAAG,CAAE,EAClB,GAAG,WAAW,GAAG,gBAAiB,EAClC,YAAW;EAErB,UAAW,UAAW;EACtB;EACA,QAAQ,qBAACE;EACT,UAAU,MAAM,UAAW,EACjB,QAAQ,MAAO,EACf,QAAQ,MAAO,EACf,yBAAgB,CAAC,WAAK,IAAE,EACxB,aAAa,aAAY,CACzB;EACV,OAAU;EACV,KAAO;EACP,IAAI;EACJ,CAAC;;ECxFDb,IAAM,KAAK,GAAG,GAAG,CAAC;EAClBA,IAAM,MAAM,GAAG,GAAG,CAAC;EACnBA,IAAM,iBAAiB,GAAG,GAAG,CAAC;AAC9B;EACAA,IAAM,GAAG,eAAS;EAClB,EAAEA,IAAM,UAAU,GAAG,aAAa,EAAE,CAAC;EACrC,EAAEA,IAAM,IAAI,GAAG,OAAO,EAAE,CAAC;AACzB;EACA,EAAE,IAAI,CAAC,UAAU,IAAI,CAAC,IAAI,EAAE;EAC5B,IAAI,OAAOY,sDAAK,aAAW,EAAM,CAAC;EAClC,GAAG;AACH;EACA,EAAE;EACF,IAAIA,kDAAK,OAAO,KAAM,EAAC,QAAQ;EAC/B,MAAMA,yCAAC,aAAU,MAAM,IAAK,EAAC,YAAY,YAAW;EACpD,MAAMA,gDAAG,8BAA0B,MAAM,GAAG,iBAAiB,GAAG,OAAM;EACtE,QAAQA,yCAAC,iBAAc,MAAM,IAAK,EAAC,OAAO,KAAM,EAAC,QAAQ,iBAAiB,GAAG,QAAO,CAAG;EACvF,OAAU;EACV,KAAU;EACV,IAAI;EACJ,CAAC,CAAC;AACF;EACAZ,IAAM,WAAW,GAAG,QAAQ,CAAC,cAAc,CAAC,MAAM,CAAC,CAAC;AACpDqB,8BAAQ,CAAC,MAAM,CAACT,yCAAC,SAAG,EAAG,EAAE,WAAW,CAAC;;;;;;"}